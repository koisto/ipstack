#include "unity.h"
#include "ip.h"


void test_checksum_calc(void)
{
	uint8_t header[20] = {0x45,0x00,0x00,0x73,0x00,0x00,0x40,0x00,0x40,0x11,0x00,0x00,0xc0,0xa8,0x00,0x01,0xc0,0xa8,0x00,0xc7};

	TEST_ASSERT_EQUAL_UINT16_MESSAGE(0xb861, ip_checksum(header, 20), "Checksum calculation incorrect");
}

void test_checksum_calc_zero(void)
{
	uint8_t header[20] = {0x45,0x00,0x00,0x73,0x00,0x00,0x40,0x00,0x40,0x11,0xb8,0x61,0xc0,0xa8,0x00,0x01,0xc0,0xa8,0x00,0xc7};

	TEST_ASSERT_EQUAL_UINT16_MESSAGE(0x0000, ip_checksum(header, 20), "Checksum calculation incorrect");
}

void test_checksum_calc_fail(void)
{
	uint8_t header[20] = {0x45,0x00,0x00,0x73,0x00,0x00,0x40,0x00,0x40,0x11,0xb8,0x61,0xc0,0xa8,0x00,0x01,0xc0,0xa8,0x00,0xc9};

	TEST_ASSERT_NOT_EQUAL_MESSAGE(0x0000, ip_checksum(header, 20), "Checksum calculation incorrect");
}


int main (void)
{
	UNITY_BEGIN();
	RUN_TEST(test_checksum_calc);
	RUN_TEST(test_checksum_calc_zero);
	RUN_TEST(test_checksum_calc_fail);

	return UNITY_END();
}